\addcontentsline{toc}{chapter}{Занятие 16. Цепи Маркова. Рекуррентность.
                                Эргодичность.}
\chapter*{Занятие 16. Цепи Маркова. Рекуррентность. Эргодичность.}

\addcontentsline{toc}{section}{Контрольные вопросы и задания}
\section*{Контрольные вопросы и задания}

\subsubsection*{Приведите определение цепи Маркова.}

Последовательность случайных величин $ \left\{ x_n, \, n \geq 0 \right\} $
со значениями в пространстве $E$ называется однородной цепью Маркова, если
\begin{equation*}
  \forall n \geq 0, \,
  j \in E \; : \;
  P \left( x_{n + 1} = j \; \middle| \; \mathcal{F}_n \right) =
  P \left( x_{n + 1} = j \; \middle| \; x_n \right) =
  P \left( x_1 = j \; \middle| \; x_0 \right),
\end{equation*}
где $E$~---~дискретное фазовое пространство, конечное или счётное множество,
$ \mathcal{F}_n = \sigma \left( x_k, \, k \leq n \right) $~---~информация,
которую мы имеем, наблюдая прошлое.

$ \left\{ x_n, \, n \geq 0 \right\} $~---~это однородная цепь Маркова с
переходной вероятностью $ \left( p_{ij} \right)_{i, j \in E}$,
если $ \forall i_0, \dotsc, i_{n + 1} \in E$ выполняется соотношение
\begin{equation*}
  \frac{P \left( x_0 = i_0, \dotsc, x_{n + 1} = i_{n + 1} \right) }{P \left( x_0 = i_0, \dotsc, x_n = i_n \right) } =
  p_{i_n i_{n + 1}}.
\end{equation*}

\subsubsection*{Как определяются переходные вероятности цепи Маркова?}

$P \left( x_1 = j \; \middle| \; x_0 \right) = p_{x_0 j}$.
Сейчас матрица $ \left( p_{ij} \right)_{i, j \in E}$~---~матрица перехода
(однородной) цепи Маркова.

\subsubsection*{Как вычисляются переходные вероятности цепи Маркова за $n$
                шагов?}

Пусть $ \left\{ x_n \right\} $~---~цепь Маркова с переходной матрицей $P$.
Тогда
\begin{equation*}
  P \left( x_n = i_n \; \middle| \; x_0 = i_0 \right) =
  p_{i_0 i_n}^{ \left( n \right) },
\end{equation*}
где $ \left( p_{ij}^{ \left( n \right) } \right)_{i, j \in E} = P^n$.

\subsubsection*{Запишите уравнение Колмогорова-Чепмена.}

Матрица переходных вероятностей удовлетворяет уравнению Колмогорова-Чепмена:
$P \left( t + s \right) = P \left( t \right) P \left( s \right) $ или
\begin{equation*}
  p_{ij} \left( t + s \right) =
  \sum \limits_{k} p_{ik} \left( t \right) p_{kj} \left( s \right).
\end{equation*}

\subsubsection*{Как классифицируются состояния цепи Маркова?}

Состояние $j$ называется достижимым из состояния $i$,
если существует путь по графу из $i$ в $j$.
Обозначение: $i \to j$.

Состояния $i$ и $j$ сообщаются, если $i \to j$ и $j \to i$.

Состояние $i$ называется несущественное, если существует такое $j$,
что $i \to j, \, j \not \to i$.

Остальные состояния существенные.

\subsubsection*{Что называется периодом состояния?}

Пусть
$A_i = \left\{ n \geq 1 \; : \; p_{ii}^{ \left( n \right) } > 0 \right\} $~---~это
длины разрешённых цепочек, которые ведут из $i$ в $i$.

Период состояния $i$~---~это наибольший общий делитель $A_i$
(нод $A_i$)~---~наибольшее натуральное число,
на которое делятся все элементы множества.

\subsubsection*{Сформулируйте утверждение про периоды сообщающихся состояний.}

Если $i \leftrightarrow j$, то нод $A_i = $ нод $A_j$.

\subsubsection*{Сформулируйте теорему про ассимптотическое поведение переходных
                вероятностей $p_{ij}^{ \left( n \right) }$ при $n \to \infty $.}

Если $E$~---~это конечный класс сообщающихся существенных состояний с периодом
1, то
$ \forall j \in E \,
  \exists \lim \limits_{n \to \infty } p_{ij}^{ \left( n \right) } = \pi_j$
и $ \pi = \left( \pi_j, \, j \in E \right) $~---~это единственное инвариантное
распределение.

Если $E$~---~конечный класс сообщающихся существенных состояний, то
\begin{equation*}
  \forall j \in E \qquad
  \exists \lim \limits_{n \to \infty }
    \frac{1}{n} \sum \limits_{s = 1}^n p_{ij}^{ \left( s \right) } = \pi_j, \,
  \pi = \left( \pi_j, \, j \in E \right),
\end{equation*}
где $ \pi $~---~единственное инвариантное распределение.

\subsubsection*{Дайте определение инвариантного распределения цепи Маркова.}

Если $E$~---~конечный класс сообщающихся состояний,
то существует инвариантное распределение $ \pi \; : \; \pi P = \pi $.

\subsubsection*{Сформулируйте индивидуальную эргодическую теорему.}

$E$~---~конечный класс сообщающихся состояний.
$ \forall f \; : \; E \to R$ имеет место
\begin{equation*}
  \frac{1}{n} \sum \limits_{k = 1}^n f \left( x_k \right) \overset{a.s.}{ \to }
  \sum \limits_{j \in E} f \left( j \right) \pi_j, \,
  n \to \infty.
\end{equation*}
В левой части стоит среднее по времени, в правой~---~среднее по пространству.

\subsubsection*{Что называется моментом остановки относительно
                последовательности $ \sigma $-алгебр,
                связанной с цепью Маркова?}

Случайная величина $T$, зависящая от $x_0, x_1, \dotsc $ и принимающая значения
$0, 1, 2, \dotsc, \infty $, называется моментом остановки,
если событие $ \left\{ T = n \right\} $
описывается только в терминах случайных величин $x_1, \dotsc, x_n$
без привлечения величин $x_{n + 1}, x_{n + 2}, \dotsc $.

\addcontentsline{toc}{section}{Аудиторные задачи}
\section*{Аудиторные задачи}

\subsubsection*{16.2}

\textit{Задание.}
Докажите, что все состояния цепи Маркова с матрицей переходных вероятностей $P$
рекуррентны, если:
\begin{enumerate}[label=\alph*)]
  \item \begin{equation*}
    P =
    \begin{bmatrix}
      1 & 0 \\
      0 & 1
    \end{bmatrix};
  \end{equation*}
  \item \begin{equation*}
    P =
    \begin{bmatrix}
      \frac{1}{2} & 0 & \frac{1}{2} & 0 \\
      0 & \frac{1}{2} & 0 & \frac{1}{2} \\
      \frac{1}{2} & 0 & \frac{1}{2} & 0 \\
      0 & \frac{1}{2} & 0 & \frac{1}{2}
    \end{bmatrix}.
  \end{equation*}
\end{enumerate}

\textit{Решение.}
\begin{enumerate}[label=\alph*)]
  \item Тут 2 состояния.
  Нужно нарисовать, как ведёт себя цепь (рис. \ref{fig:162}).

  \begin{figure}[h]
    \centering
    \includestandalone[mode=buildnew]{./pictures/16_2}
    \caption{Состояния и переходы цепи Маркова}
    \label{fig:162}
  \end{figure}

  $i = 1, 2, \, P \left( \tau_i = 1 \; \middle| \; x_0 = 1 \right) = 1$.

  За 1 шаг возвращаемся в состояние $i$;
  \item нужно нарисовать, как ведёт себя цепь (рис. \ref{fig:1621}).

  \begin{figure}[h]
    \centering
    \includestandalone[mode=buildnew]{./pictures/16_2_1}
    \caption{Состояния и переходы цепи Маркова}
    \label{fig:1621}
  \end{figure}

  Получили 2 класса эквивалентности.
  То есть нас интересует
  \begin{equation*}
    P \left( \tau_1 < \infty \; \middle| \; x_0 = 1 \right) =
    \sum \limits_{n = 1}^{ \infty }
      P \left( \tau_1 = n \; \middle| \; x_0 = 1 \right) =
  \end{equation*}
  Это событие означает, что мы в первый раз вернулись на $n$-м шаге
  \begin{equation*}
    = \sum \limits_{n = 1}^{ \infty } \frac{1}{2^n} =
    1.
  \end{equation*}
\end{enumerate}

Критерий рекуррентности: $i$ рекурентное тогда и только тогда, когда
\begin{equation*}
  \sum \limits_{n = 1}^{ \infty } p_{ii}^{ \left( n \right) } =
  \infty.
\end{equation*}
