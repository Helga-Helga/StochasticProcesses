\addcontentsline{toc}{chapter}{Занятие 11. Стационарные случайные последовательности.}
\chapter*{Занятие 11. Стационарные случайные последовательности.}

\addcontentsline{toc}{section}{Контрольные вопросы и задания}
\section*{Контрольные вопросы и задания}

\subsubsection*{Приведите определение стационарной случайной последовательности.}

Последовательность $ \left\{ \xi_n, \, n \in \mathbb{Z} \right\} $ называется стационарной
(в широком смысле), если
$M \xi_n = M \xi_0, \, n \in \mathbb{Z}, \,
  cov \left( \xi_{n + m}, \xi_m \right) = cov \left( \xi_n, \xi_0 \right), \, n, m \in \mathbb{Z}.$

\subsubsection*{Приведите примеры стационарных случайных последовательностей.}

\begin{enumerate}
  \item $ \xi_n = \eta \cdot e^{i \lambda n}, \, n \in \mathbb{Z}$,
  где $ \lambda \in \mathbb{R}, \, \eta $~---~случайная величина такая,
  что $M \eta = 0$ и $M \left| \eta \right|^2 \equiv \sigma^2 < +\infty $.

  При этом
  \begin{equation*}
    cov \left( \xi_{n + m}, \xi_m \right) =
    M \left[
      \eta \cdot e^{i \lambda \left( n + m \right) } \cdot \overline{ \eta } \cdot e^{-i \lambda m}
    \right] =
    M \left| \eta \right|^2 \cdot e^{i \lambda n} =
    \sigma^2 \cdot e^{i \lambda n} =
  \end{equation*}
  Нет зависимости от $m$,
  есть зависимость только от разностей
  \begin{equation*}
    \left( n + m \right) - m = n + m - m = n.
  \end{equation*}
  Получаем
  \begin{equation*}
    = K \left( n \right).
  \end{equation*}
  \item Пусть
  \begin{equation*}
    \eta_n =
    \sum \limits_{k = 1}^N \eta_k e^{i \lambda_k n}, \,
    n \in \mathbb{Z},
  \end{equation*}
  где $ \eta_1, \dotsc, \eta_N$~---~случайные величина с $M \eta_i = 0, \, 1 \leq i \leq N$ и
  \begin{equation*}
    M \eta_i \overline{ \eta_j} = 0, \,
    1 \leq i, j \leq N, \,
    i \neq j,
  \end{equation*}
  и $M \left| \eta_i \right|^2 = \sigma_i^2$,
  а $ \lambda_i \neq \lambda_j, \, i \neq j$~---~действительные числа.
  Тогда
  \begin{equation*}
    cov \left( \xi_{n + m}, \xi_n \right) =
    M \left[
      \sum \limits_{k = 1}^N \eta_k e^{i \lambda_k \left( n + m \right) } \cdot
      \sum \limits_{l = 1}^N \overline{ \eta_l} e^{-i \lambda_l m}
    \right] =
  \end{equation*}
  Запишем произведение двух сумм в виде двойной суммы
  \begin{equation*}
    = \sum \limits_{k = 1}^N
      \sum \limits_{l = 1}^N \left[
        M \eta_k \overline{ \eta }_l \cdot e^{i \lambda_k \left( n + m \right) } e^{-i \lambda_l m}
      \right] =
  \end{equation*}
  Воспользуемся тем, что $M \eta_i \overline{ \eta }_j = 0$.
  Получим
  \begin{equation*}
    = \sum \limits_{k = 1}^n \sigma_k^2 \cdot e^{i \lambda_k n} =
  \end{equation*}
  Ковариационная функция элементов последовательности зависит только от разности их индексов
  \begin{equation*}
    = K \left( n \right).
  \end{equation*}
\end{enumerate}

\subsubsection*{Сформулируйте теорему Герглотца про спектральное изображение ковариационной функции
                стационарной случайной последовательности.}

Если $k$~---~ковариационная функция стационарной в широком смысле последовательности,
то существует мера на
$ \left( \left[ -\pi, \pi \right], \beta \left( \left[ -\pi, \pi \right] \right) \right) $,
где $ \beta $~---~борелевская $ \sigma$-алгебра.
Мера такая, что
\begin{equation*}
  k \left( n \right) =
  \frac{1}{2 \pi } \int \limits_{-\pi }^{ \pi } e^{i \lambda n} \mu \left( d \lambda \right), \,
  n \in \mathbb{Z}.
\end{equation*}

\subsubsection*{Что называется спектральной функцией, спектральной плотностью стационарной случайной
                последовательности?}

Мера $ \mu $, которая фигурировала в теореме Герглотца, называется спектральной мерой, а функция
$f \left( \lambda \right) := \mu \left( \left[ \-\pi, \pi \right] \right), \,
  -\pi \leq \lambda < \pi $~---~спектральной
функцией стационарной последовательности с ковариационной функцией $k$.

\addcontentsline{toc}{section}{Аудиторные задачи}
\section*{Аудиторные задачи}

\subsubsection*{11.2}

\textit{Задание.}
Пусть $ \left\{ \xi_n \right\}_{n \in \mathbb{Z}}$~---стационарная
в широком смысле последовательность, $M \xi_n = 2, R \left( n \right) = 2^{-\left| n \right| }$.
Вычислите:
\begin{equation*}
  cov \left( \xi_3, \xi_5 \right), \,
  cov \left( \xi_{100}, \xi_{105} \right), \,
  M \xi_2 \xi_8, \,
  D \xi_4.
\end{equation*}

\textit{Решение.}
Посчитаем ковариационную функцию $R$ от разности аргументов
\begin{equation*}
  cov \left( \xi_3, \xi_5 \right) =
  R \left( 2 \right) =
  \frac{1}{4}.
\end{equation*}

Дальше $cov \left( \xi_{100}, \xi_{105} \right) = R \left( 5 \right) = 2^{-5}$.

Перепишем следующее математическое ожидание через ковариацию
\begin{equation*}
  M \xi_2 \xi_8 =
  cov \left( \xi_2, \xi_8 \right) + M \xi_2 \cdot M \xi_8 =
  K \left( 6 \right) + 2 \cdot 2 =
  2^{-6} + 4.
\end{equation*}

Найдём дисперсию $D \xi_4 = cov \left( \xi_4, \xi_4 \right) = R \left( 0 \right) = 2^{-0} = 1$.

\subsubsection*{11.3}

\textit{Задание.}
Пусть $ \left\{ \xi_n \right\}_{n \in \mathbb{Z}}$~---~последовательность
независимых одинаково распределённых случайных величин таких,
что $M \xi_1 = 0, \, M \xi_1^2 = \sigma^2$.
Положим $ \eta_n = \xi_n + \xi_{n - 1} + \dotsc + \xi_{n - m}, \, n \in \mathbb{Z}, \, m = const$.
Докажите, что $ \left\{ \eta_n \right\}_{n \in \mathbb{Z}}$
образует стационарную в широком смысле последовательность и найдите её ковариационную функцию.

\textit{Решение.}
Нужно найти математическое ожидание
\begin{equation*}
  M \eta_n =
  M \left( \xi_n + \xi_{n - 1} + \dotsc + \xi_{n - m} \right) =
  M \xi_n + M \xi_{n - 1} + \dotsc + M \xi_{n - m} =
  0,
\end{equation*}
потому что у каждого слагаемого математическое ожидание 0.
Теперь ещё нужно найти ковариационную функцию
\begin{equation*}
  cov \left( \eta_n, \eta_j \right) =
  cov \left(
    \xi_n + \xi_{n - 1} + \dotsc + \xi_{n - m}, \xi_j + \xi_{j - 1} + \dotsc + \xi_{j - m}
  \right) =
\end{equation*}
Сдучайные величины $ \xi $ независимые и одинаково распределённые
\begin{equation*}
  = cov \left( \sum \limits_{k = n - m}^n \xi_k, \sum \limits_{i = j - m}^j \xi_i \right) =
\end{equation*}
Суммы можно вынести
\begin{equation*}
  = \sum \limits_{k = n - m, \, i = j - m}^{n, j} cov \left( \xi_k, \xi_i \right) =
  \sum \limits_{k = n - m}^n \sum \limits_{i = j - m}^j M \left( \xi_k \xi_j \right) =
\end{equation*}
Когда индексы одинаковые~---~это $ \sigma^2$, когда индексы разные~---~это 0.
Получаем
\begin{equation*}
  = \sigma^2 \cdot \# \left\{
    \left( k, i \right) \; : \; k = i, \, k = \overline{n - m, n}, \, i = \overline{j = m, j}
  \right\},
\end{equation*}
где $ \# $~---~количество.

$k = \overline{n - m, n}$; для этого же $k$ выполняется $k = \overline{j - m, j}$.

Первое условие: $k \geq \max \left( n - m, j - m \right) = \max \left( n, j \right) - m$.

Второе условие: $k \leq \min \left( n, j \right) $.

Случай номер 1: верхняя граница меньше чем нижняя граница.
Тогда решений нет, и ковариация будет 0.
Это в том случае, если
\begin{equation*}
  \min \left( n, j \right) < \max \left( n, j \right) - m
\end{equation*}
тогда и только тогда, когда $ \left| n - s \right| > m$.

Второй случай:
когда $ \min \left( n, j \right) \geq \max \left( n, j \right) - m$ тогда и только тогда,
когда $ \left| n - j \right| \leq m$.
Количество пар индексов
\begin{equation*}
  \min \left( n, j \right) - \max \left( n, j \right) + m + 1 =
  m + 1 - \left| n - j \right|.
\end{equation*}

Нашли ковариационную функцию, и она получилась такой
\begin{equation*}
  K \left( \xi_n, \xi_j \right) =
  \begin{cases}
    0, \qquad \left| n - j \right| > m, \\
    \sigma^2 \left( m + 1 - \left| n - j \right| \right), \qquad \left| n - j \right| \leq m.
  \end{cases}
\end{equation*}

Так что это действительно стационарная последовательность.

\subsubsection*{11.4}

\textit{Задание.}
Найдите спектральную плотноть стационарной в широком смысле последовательности
$ \left\{ \xi_n \right\}_{n \in \mathbb{Z}}$, если её ковариационная функция $R_{ \xi }$ равна:
\begin{enumerate}[label=\alph*)]
  \item $R_{ \xi } \left( n \right) =
    \begin{cases}
      1, \qquad n = 0, \\
      0, \qquad n \neq 0;
    \end{cases}$
  \item $R_{ \xi } \left( n \right) =
    \begin{cases}
      4, \qquad n = 0, \\
      1, \qquad \left| n \right| = 1, \\
      0, \qquad \left| n \right| > 1.
    \end{cases}$
\end{enumerate}

\textit{Решение.}
\begin{enumerate}[label=\alph*)]
  \item
  \begin{equation*}
    R \left( n \right) =
    \begin{cases}
      1, \qquad n = 0, \\
      0, \qquad n \neq 0
    \end{cases} =
    \frac{1}{2 \pi }
    \int \limits_{-\pi }^{ \pi } e^{i \lambda n} f \left( \lambda \right) d \lambda.
  \end{equation*}
  Нужно найти $f \left( \lambda \right) $.

  Проверим, что
  \begin{equation*}
    f \left( \lambda \right) =
    \sum \limits_{n = -\infty }^{+\infty } e^{-i \lambda n} R \left( n \right)
  \end{equation*}
  это формула обращения.

  Проверим, что $f \left( \lambda \right) $~---~плотность.
  Посчитаем
  \begin{equation*}
    \frac{1}{2 \pi }
    \int \limits_{-\pi }^{ \pi }
      e^{i \lambda n} \sum \limits_{k = -\infty }^{+\infty } e^{-i \lambda k} R \left( k \right)
    d \lambda =
  \end{equation*}
  Здесь
  \begin{equation*}
    \sum \limits_{k = -\infty }^{+\infty } e^{-i \lambda k} R \left( k \right) =
    f \left( \lambda \right).
  \end{equation*}
  Сумму и $R$ выносим за интеграл
  \begin{equation*}
    = \sum \limits_{k = -\infty }^{+\infty }
      R \left( k \right) \cdot \frac{1}{2 \pi }
      \int \limits_{-\pi }^{ \pi } e^{i \lambda \left( n - k \right) } d \lambda =
    R \left( n \right),
  \end{equation*}
  когда $k = n$.

  Когда $k \neq n$, то
  \begin{equation*}
    \int \limits_{-\pi }^{ \pi } e^{i \lambda \left( n - k \right) } d \lambda =
    \left.
      \frac{1}{i \left( n - k \right) } \cdot e^{i \lambda \left( n - k \right) }
    \right|_{-\pi }^{ \pi } =
    0,
  \end{equation*}
  потому что экспонента~---~периодическая с периодом $2 \pi $.
  В нашей ситуации
  \begin{equation*}
    f \left( \lambda \right) =
    \sum \limits_{n - \infty }^{+\infty } R \left( n \right) e^{i \lambda n} =
  \end{equation*}
  Остаётся слагаемое только при $n = 0$.
  Получается
  \begin{equation*}
    = 1.
  \end{equation*}

  Эта последовательность называется белый шум.
  У него постоянная плотность.
  \item $f \left( \lambda \right) =
    4 + e^{i \lambda } + e^{-i \lambda } =
    4 + 2 \cos \lambda $,
  где 4~---~при $n = 0$, слагаемое $e^{i \lambda }$~---~при $n = 1$,
  а слагаемое $e^{-i \lambda }$~---~при $n = -1$.
\end{enumerate}

\subsubsection*{11.5}

\textit{Задание.}
Пусть
\begin{equation*}
  \xi_n =
  \sum \limits_{k = 0}^{ \infty } \frac{1}{3^k} \cdot \varepsilon_{n - k},
\end{equation*}
где $ \left\{ \varepsilon_k \right\}_{k \in \mathbb{Z}}$~---~последовательность
независимых одинаково распределённых случайных величин со стандартным нормальным распределением.
Найдите ковариационную функцию и спектральную плотность последовательности
$ \left\{ \xi_n \right\}_{n \in \mathbb{Z}}$.

\textit{Решение.}
$ \varepsilon_n$ обозначает белый шум.

\begin{equation*}
  M \varepsilon_n = 0, \,
  cov \left( \varepsilon_n, \varepsilon_k \right) =
  \begin{cases}
    1, \qquad n = k, \\
    0, \qquad n \neq k.
  \end{cases}
\end{equation*}

Считаем ковариационную функцию.
Подставляем сумму
\begin{equation*}
  cov \left( \xi_n, \xi_s \right) =
  cov \left(
    \sum \limits_{k = 0}^{ \infty } \frac{1}{3^k} \cdot \varepsilon_{n - k},
    \sum \limits_{j = 0}^{ \infty } \frac{1}{3^j} \cdot \varepsilon_{s - j}
  \right) =
\end{equation*}
Выносим сумму и коэффициенты
\begin{equation*}
  \sum \limits_{k, j = 0}^{ \infty }
    \frac{1}{3^k} \cdot \frac{1}{3^j} \cdot
    cov \left( \varepsilon_{n - k}, \varepsilon_{s - j} \right) =
\end{equation*}
Из внутренней сумы нужно оставить только одно слагаемое, когда
\begin{equation*}
  n - k =
  s - j.
\end{equation*}
Отсюда $j = s - n + k \geq 0, \, s \geq n$.
Получим
\begin{equation*}
  = \sum \limits_{k = 0}^{ \infty } \frac{1}{3^k} \cdot \frac{1}{3^{s - n + k}} =
  \sum \limits_{k = 0}^{ \infty } \frac{1}{3^{k + s - n + k}} =
  \sum \limits_{k = 0}^{ \infty } \frac{1}{3^{2k + s - n}} =
\end{equation*}
Сумма геометрической прогрессии
\begin{equation*}
  \frac{1}{3^{s - n}} \sum \limits_{k = 0}^{ \infty } \frac{1}{3^{2k}} =
  \frac{1}{3^{s - n}} \cdot \frac{1}{1 - \frac{1}{9}} =
  \frac{9}{8 \cdot 3^{s - n}}.
\end{equation*}

В ответе будет стоять модуль.
Итого, ковариационная функция $ \xi $~---~это
\begin{equation*}
  R_{ \xi } \left( n \right) =
  \frac{9}{8 \cdot 3^{ \left| n \right| }}.
\end{equation*}
Теперь найдём спектральную плотность для такой ковариационной функции
\begin{equation*}
  f \left( \lambda \right) =
  \sum \limits_{n = -\infty }^{+\infty } e^{-i \lambda n} R_{ \xi } \left( n \right) =
  \sum \limits_{n = -\infty }^{+\infty }
    e^{-i \lambda n} \cdot \frac{9}{8 \cdot 3^{ \left| n \right| }} =
\end{equation*}
Разбиваем на две суммы
\begin{gather*}
  = \sum \limits_{n = 0}^{+\infty } e^{-i \lambda n} \cdot \frac{1}{3^n} \cdot \frac{9}{8} +
  \sum \limits_{n = 1}^{+\infty } \left( \frac{e^{i \lambda }}{3} \right)^n \cdot \frac{9}{8} =
  \left(
    \frac{1}{1 - \frac{e^{-i \lambda }}{3}} +
    \frac{ \frac{e^{i \lambda }}{3}}{1 - \frac{e^{i \lambda }}{3}}
  \right) \cdot \frac{9}{8} = \\
  = \frac{9}{8} \cdot
  \left( \frac{3}{3 - e^{-i \lambda }} + \frac{e^{i \lambda }}{3 - e^{i \lambda }} \right) =
\end{gather*}
Приведём к общему знаменателю
\begin{gather*}
  = \frac{9}{8} \cdot
  \frac{9 - 3e^{i \lambda } + 3e^{i \lambda } - 1}{ \left( 3 - e^{-i \lambda } \right) \left( 3 - e^{i \lambda } \right) } =
  \frac{9}{8} \cdot
  \frac{8}{ \left( 3 - e^{-i \lambda } \right) \left( 3 - e^{i \lambda } \right) } =
  \frac{9}{9 - 3e^{i \lambda } - 3e^{-i \lambda } + 1} = \\
  = \frac{9}{10 - 3e^{-i \lambda } - 3e^{i \lambda }} =
  \frac{9}{10 - 6 \cos \lambda }.
\end{gather*}

Это спектральная плотность.

Вычисление спектральной плотности можно было делать проще.

$f_{ \varepsilon } = 1$, потому что $ \varepsilon $~---~это белый шум.

\begin{equation*}
  f_{ \xi } \left( \lambda \right) =
  \left| \sum \limits_{k = 0}^{ \infty } \frac{1}{3^k} \cdot ^{-i \lambda k} \right|^2 \cdot 1 =
  \left| \frac{1}{1 - \frac{e^{-i \lambda }}{3}} \right|^2 =
  \left| \frac{3}{3 - e^{-i \lambda }} \right|^2 =
  \frac{9}{ \left( 3 - \cos \lambda \right)^2 + \sin^2 \lambda } =
\end{equation*}
Раскроем квадрат
\begin{equation*}
  = \frac{9}{10 - 6 \cos \lambda }.
\end{equation*}

Таким образом,
\begin{equation*}
  R \left( n \right) =
  \frac{1}{2 \pi }
  \int \limits_{-\pi }^{ \pi } e^{i \lambda n} \cdot \frac{9}{10 - 6 \cos \lambda} \cdot d \lambda =
  \frac{9}{8 \cdot 3^{ \left| n \right| }}.
\end{equation*}
